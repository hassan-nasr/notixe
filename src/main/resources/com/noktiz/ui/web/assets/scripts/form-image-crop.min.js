var FormImageCrop=function(){var a=function(){$("#demo1").Jcrop()};var h=function(){var j;$("#demo2").Jcrop({onChange:l,onSelect:l,onRelease:k},function(){j=this});$("#coords").on("change","input",function(q){var n=$("#x1").val(),m=$("#x2").val(),p=$("#y1").val(),o=$("#y2").val();j.setSelect([n,p,m,o])});function l(m){$("#x1").val(m.x);$("#y1").val(m.y);$("#x2").val(m.x2);$("#y2").val(m.y2);$("#w").val(m.w);$("#h").val(m.h)}function k(){$("#coords input").val("")}};var g=function(){var r,p,o,l=$("#preview-pane"),q=$("#preview-pane .preview-container"),k=$("#preview-pane .preview-container img"),n=q.width(),m=q.height();console.log("init",[n,m]);$("#demo3").Jcrop({onChange:j,onSelect:j,aspectRatio:n/m},function(){var s=this.getBounds();p=s[0];o=s[1];r=this;l.appendTo(r.ui.holder)});function j(u){if(parseInt(u.w)>0){var t=n/u.w;var s=m/u.h;k.css({width:Math.round(t*p)+"px",height:Math.round(s*o)+"px",marginLeft:"-"+Math.round(t*u.x)+"px",marginTop:"-"+Math.round(s*u.y)+"px"})}}};var f=function(){var s;$("#demo4").Jcrop({bgFade:true,bgOpacity:0.2,setSelect:[60,70,540,330]},function(){s=this});$("#fadetog").change(function(){s.setOptions({bgFade:this.checked})}).attr("checked",true);App.updateUniform("#fadetog");$("#shadetog").change(function(){if(this.checked){$("#shadetxt").slideDown()}else{$("#shadetxt").slideUp()}s.setOptions({shade:this.checked})}).attr("checked",false);var q={bgc_buttons:"Change bgColor",bgo_buttons:"Change bgOpacity",anim_buttons:"Animate Selection"};var r={anim1:[217,122,382,284],anim2:[20,20,580,380],anim3:[24,24,176,376],anim4:[347,165,550,355],anim5:[136,55,472,183]};var n={Low:0.2,Mid:0.5,High:0.8,Full:1};var k={R:"#900",B:"#4BB6F0",Y:"#F0B207",G:"#46B81C",W:"white",K:"black"};for(i in q){l(i,q[i])}function o(u){var t=$("<button />").addClass("btn btn-small");if(u){t.append(u)}return t}var m=1;for(i in r){$("#anim_buttons .btn-group").append(o(m++).click(j(r[i]))," ")}$("#anim_buttons .btn-group").append(o("Bye!").click(function(t){$(t.target).addClass("active");s.animateTo([300,200,300,200],function(){this.release();$(t.target).closest(".btn-group").find(".active").removeClass("active")});return false}));for(i in n){$("#bgo_buttons .btn-group").append(o(i).click(p("bgOpacity",n[i]))," ")}for(i in k){$("#bgc_buttons .btn-group").append(o(i).css({background:k[i],color:((i=="K")||(i=="R"))?"white":"black"}).click(p("bgColor",k[i]))," ")}function l(u,t){$("#interface").prepend($("<fieldset></fieldset>").attr("id",u).append($("<legend></legend>").append(t),'<div class="btn-toolbar"><div class="btn-group"></div></div>'))}function p(u,t){return function(w){$(w.target).closest(".btn-group").find(".active").removeClass("active");$(w.target).addClass("active");var v={};v[u]=t;s.setOptions(v);return false}}function j(t){return function(u){$(u.target).addClass("active");s.animateTo(t,function(){$(u.target).closest(".btn-group").find(".active").removeClass("active")});return false}}$("#bgo_buttons .btn:first,#bgc_buttons .btn:last").addClass("active");$("#interface").show()};var e=function(){var j;k();function k(){$(".requiresjcrop").hide();$("#demo5").Jcrop({onRelease:m},function(){j=this;j.animateTo([100,100,400,300]);$("#can_click,#can_move,#can_size").attr("checked","checked");App.updateUniform("#can_click,#can_move,#can_size");$("#ar_lock,#size_lock,#bg_swap").attr("checked",false);App.updateUniform("#ar_lock,#size_lock,#bg_swap");$(".requiresjcrop").show()})}function l(){var n=j.getBounds();return[Math.round(Math.random()*n[0]),Math.round(Math.random()*n[1]),Math.round(Math.random()*n[0]),Math.round(Math.random()*n[1])]}function m(){j.setOptions({allowSelect:true});$("#can_click").attr("checked",false);App.updateUniform("#can_click")}$("#setSelect").click(function(n){j.setSelect(l())});$("#animateTo").click(function(n){j.animateTo(l())});$("#release").click(function(n){j.release()});$("#disable").click(function(n){j.disable();$("#enable").show();$(".requiresjcrop").hide()});$("#enable").click(function(n){j.enable();$("#enable").hide();$(".requiresjcrop").show()});$("#rehook").click(function(n){$("#rehook,#enable").hide();k();$("#unhook,.requiresjcrop").show();return false});$("#unhook").click(function(n){j.destroy();$("#unhook,#enable,.requiresjcrop").hide();$("#rehook").show();return false});$("#img1").click(function(n){$(this).addClass("active").closest(".btn-group").find("button.active").not(this).removeClass("active");j.setImage("assets/plugins/jcrop/demos/demo_files/sago.jpg");j.setOptions({bgOpacity:0.6});return false});$("#img2").click(function(n){$(this).addClass("active").closest(".btn-group").find("button.active").not(this).removeClass("active");j.setImage("assets/plugins/jcrop/demos/demo_files/pool.jpg");j.setOptions({bgOpacity:0.6});return false});$("#img3").click(function(n){$(this).addClass("active").closest(".btn-group").find("button.active").not(this).removeClass("active");j.setImage("assets/plugins/jcrop/demos/demo_files/sago.jpg",function(){this.setOptions({bgOpacity:1,outerImage:"assets/plugins/jcrop/demos/demo_files/sagomod.jpg"});this.animateTo(l())});return false});$("#can_click").change(function(n){j.setOptions({allowSelect:!!this.checked});j.focus()});$("#can_move").change(function(n){j.setOptions({allowMove:!!this.checked});j.focus()});$("#can_size").change(function(n){j.setOptions({allowResize:!!this.checked});j.focus()});$("#ar_lock").change(function(n){j.setOptions(this.checked?{aspectRatio:4/3}:{aspectRatio:0});j.focus()});$("#size_lock").change(function(n){j.setOptions(this.checked?{minSize:[80,80],maxSize:[350,350]}:{minSize:[0,0],maxSize:[0,0]});j.focus()})};var d=function(){var j;$("#demo6").Jcrop({bgOpacity:0.5,bgColor:"white",addClass:"jcrop-light"},function(){j=this;j.setSelect([130,65,130+350,65+285]);j.setOptions({bgFade:true});j.ui.selection.addClass("jcrop-selection")});$("#buttonbar").on("click","button",function(l){var m=$(this),k=m.closest(".btn-group");k.find("button.active").removeClass("active");m.addClass("active");k.find("[data-setclass]").each(function(){var o=$(this),p=o.data("setclass"),n=o.hasClass("active");if(n){j.ui.holder.addClass(p);switch(p){case"jcrop-light":j.setOptions({bgColor:"white",bgOpacity:0.5});break;case"jcrop-dark":j.setOptions({bgColor:"black",bgOpacity:0.4});break;case"jcrop-normal":j.setOptions({bgColor:$.Jcrop.defaults.bgColor,bgOpacity:$.Jcrop.defaults.bgOpacity});break}}else{j.ui.holder.removeClass(p)}})})};var c=function(){var j={x:13,y:7,x2:487,y2:107,w:474,h:100};$("#demo7").Jcrop({bgFade:true,setSelect:[j.x,j.y,j.x2,j.y2]})};var b=function(){$("#demo8").Jcrop({aspectRatio:1,onSelect:j});function j(k){$("#crop_x").val(k.x);$("#crop_y").val(k.y);$("#crop_w").val(k.w);$("#crop_h").val(k.h)}$("#demo8_form").submit(function(){if(parseInt($("#crop_w").val())){return true}alert("Please select a crop region then press submit.");return false})};return{init:function(){if(!jQuery().Jcrop){return}a();h();g();f();e();d();c();b()}}}();