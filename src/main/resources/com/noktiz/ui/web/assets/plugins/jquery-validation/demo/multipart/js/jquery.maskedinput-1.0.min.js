(function(c){function a(f){var g={begin:0,end:0};if(f.setSelectionRange){g.begin=f.selectionStart;g.end=f.selectionEnd}else{if(document.selection&&document.selection.createRange){var e=document.selection.createRange();g.begin=0-e.duplicate().moveStart("character",-100000);g.end=g.begin+e.text.length}}return g}function d(f,g){if(f.setSelectionRange){f.focus();f.setSelectionRange(g,g)}else{if(f.createTextRange){var e=f.createTextRange();e.collapse(true);e.moveEnd("character",g);e.moveStart("character",g);e.select()}}}var b={"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"};c.mask={addPlaceholder:function(f,e){b[f]=e}};c.fn.mask=function(e,j){j=c.extend({placeholder:"_",completed:null},j);var f="^";for(var g=0;g<e.length;g++){f+=(b[e.charAt(g)]||("\\"+e.charAt(g)))}f+="$";var h=new RegExp(f);return this.each(function(){var m=c(this);var k=new Array(e.length);var l=new Array(e.length);for(var n=0;n<e.length;n++){l[n]=b[e.charAt(n)]==null;k[n]=l[n]?e.charAt(n):j.placeholder}m.focus(function(){o();q();d(this,0)});m.blur(o);if(c.browser.msie){this.onpaste=function(){setTimeout(o,0)}}else{if(c.browser.mozilla){this.addEventListener("input",o,false)}}var r=false;m.keydown(function(s){var t=a(this);var i=s.keyCode;r=(i<16||(i>16&&i<32)||(i>32&&i<41));if((t.begin-t.end)!=0&&(!r||i==8||i==46)){p(t.begin,t.end)}if(i==8){while(t.begin-->=0){if(!l[t.begin]){k[t.begin]=j.placeholder;if(c.browser.opera){q(t.begin);d(this,t.begin+1)}else{q();d(this,t.begin)}return false}}}else{if(i==46){p(t.begin,t.begin+1);q();d(this,t.begin);return false}else{if(i==27){p(0,e.length);q();d(this,0);return false}}}});m.keypress(function(w){if(r){r=false;return}w=w||window.event;var t=w.charCode||w.keyCode||w.which;var x=a(this);var v=x.begin;if(w.ctrlKey||w.altKey){return true}else{if((t>=41&&t<=122)||t==32||t>186){while(x.begin<e.length){var s=b[e.charAt(x.begin)];var u;if(s){var i=new RegExp(s);u=String.fromCharCode(t).match(i)}else{x.begin+=1;x.end=x.begin;v+=1;continue}if(u){k[x.begin]=String.fromCharCode(t)}else{return false}while(++v<e.length){if(!l[v]){break}}break}}else{return false}}q();if(j.completed&&v>=k.length){j.completed.call(m)}else{d(this,v)}return false});function p(u,s){for(var t=u;t<s;t++){if(!l[t]){k[t]=j.placeholder}}}function q(v){var u="";for(var t=0;t<e.length;t++){u+=k[t];if(t==v){u+=j.placeholder}}m.val(u);return u}function o(){var x=m.val();var w=0;for(var u=0;u<e.length;u++){if(!l[u]){while(w++<x.length){var t=new RegExp(b[e.charAt(u)]);if(x.charAt(w-1).match(t)){k[u]=x.charAt(w-1);break}}}}var v=q();if(!v.match(h)){m.val("");p(0,e.length)}}})}})(jQuery);