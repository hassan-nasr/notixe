!function(d){var g="<img src='assets/bootstrap-tree/bootstrap-tree/img/ajax-loader.gif' class='indicator' /> Loading ...";var e=function(i,h){this.$element=d(i);this.$tree=this.$element.closest(".tree");this.parentage=c(this.$element);this.options=d.extend({},d.fn.tree.defaults,h);if(this.options.parent){this.$parent=d(this.options.parent)}this.options.toggle&&this.toggle()};e.prototype={constructor:e,toggle:function(){var i,l,k,h=this.$element.hasClass("in"),j=(!h)?"openbranch":"closebranch";this.$parent[h?"addClass":"removeClass"]("closed");this.$element[h?"removeClass":"addClass"]("in");if(this.options.href){this._load()}l=this.node();i=d.Event(j,{node:l});k=d.Event("nodeselect",{node:l});this.$parent.trigger(i).trigger(k)},_load:function(){var j=d.extend({},this.options),i=this.$element,k=d(this),h=this.options;delete j.parent;delete j.href;delete j.callback;d.post(h.href,j,function(r,o,m){var q,n="html";if(h.callback){var l=window[h.callback].apply(i,[r,o,m]);q=l.doc||r;n=l.type||n}else{try{q=d.parseJSON(r);n="json"}catch(p){q=r}if(n!=="json"){try{q=d.parseXML(r);n="xml"}catch(p){q=r}}}switch(n){case"html":i.html(q);break;default:k[0]._buildOutput(q,n,i);break}},"html")},_buildOutput:function(k,j,i){var h=this._buildNodes(k,j);i.empty().append(this._createNodes(h))},_createNodes:function(h){var i=[],j=d(this);d.each(h,function(q,o){var p=d("<li>"),r=(o.leaf)?"leaf":"branch",k={},l=d("<a>");k.role=r;if(!o.leaf){var n=d("<ul>").addClass("branch");k["class"]="tree-toggle closed";k["data-toggle"]="branch"}if(o.value){k["data-value"]=o.value}if(o.id){k["data-itemid"]=o.id}for(var m in o){if(m.indexOf("data-")!==-1){k[m]=o[m]}}k.href=(o.href)?o.href:"#";if(o.leaf&&k.href==="#"){l=d("<span>");delete k.href}l.attr(k);if(o.cls){l.addClass(o.cls)}if(!o.leaf&&o.expanded&&o.children.length){l.removeClass("closed");n.addClass("in")}l.html(o.text);p.append(l);if(!o.leaf&&o.children&&o.children.length){n.append(j[0]._createNodes(o.children));p.append(n)}i.push(p)});return i},_buildNodes:function(k,j){var h=[],i=this.$element;if(j==="json"){h=this._parseJsonNodes(k)}else{if(j==="xml"){h=this._parseXmlNodes(d(k).find("nodes").children())}}return h},_parseJsonNodes:function(j){var h=[],i=d(this);d.each(j,function(o,k){var n={},m=["leaf","expanded","checkable","checked"];for(var l in k){var p=(l!=="children")?k[l]:i[0]._parseJsonNodes(k.children);if(!d.isArray(p)){p=d.trim(p)}if(p.length){n[l]=(d.inArray(l,m)>-1)?f(p):p}}h.push(new b(n))});return h},_parseXmlNodes:function(k){var h=[],j=d(this),i=["leaf","expanded","checkable","checked"];d.each(k,function(o,m){var n={},l=d(m);d.each(l.children(),function(p,r){var t=d(r),q=t[0].nodeName,s=(q!=="children")?t.text():j[0]._parseXmlNodes(t.children("node"));if(!d.isArray(s)){s=d.trim(s)}if(s.length){n[q]=(d.inArray(q,i)>-1)?f(s):s}});h.push(new b(n))});return h},getparentage:function(){return this.parentage},node:function(h){h=h||d(this);var i=d.extend(true,{},(h[0]===d(this)[0])?d(this.$parent).data():h.data());i.branch=this.$element;i.parentage=this.parentage;i.el=(h[0]===d(this)[0])?this.$parent:h;delete i.parent;return i}};var b=function(h){d.extend(true,this,{text:undefined,leaf:false,value:undefined,expanded:false,cls:undefined,id:undefined,href:undefined,checkable:false,checked:false,children:[]},h)};var a=function(h){return h.closest("ul.branch").prev(".tree-toggle")};var c=function(j){var h=[],i;i=a(j);if(i.length){h=c(i);h.push(i.attr("data-value")||i.text())}return h};var f=function(h){h=d.trim(h);if(typeof h==="undefined"||h===null){return false}if(typeof h==="string"&&!isNaN(h)){h=parseFloat(h)}if(typeof h==="string"){switch(h.toLowerCase()){case"true":case"yes":return true;case"false":case"no":return false}}return Boolean(h)};d.fn.tree=function(h){return this.each(function(){var k=d(this),j=k.data("tree"),i=typeof h=="object"&&h;if(!j){k.data("tree",(j=new e(this,i)))}if(typeof h=="string"){j[h]()}})};d.fn.tree.defaults={toggle:true};d.fn.tree.Constructor=e;d(function(){d("body").on("click.tree.data-api","[data-toggle=branch]",function(l){l.preventDefault();var k=d(this),j=k.next(".branch"),h=k.attr("href"),i=d(j).data("tree")?"toggle":k.data();h.replace(/.*(?=#[^\s]+$)/,"");if(!j.length){j=d("<ul>").addClass("branch").append("<li>"+g+"</li>").insertAfter(k)}i.parent=k;i.href=(h!=="#")?h:undefined;d(j).tree(i);return false});d("body").on("click.tree.data-api","[data-role=leaf]",function(n){var m=d(this),j=m.closest(".branch");if(!d(j).data("tree")){var h=d(j),k=h.prev("[data-toggle=branch]"),l=k.data(),i=k.attr("href");i.replace(/.*(?=#[^\s]+$)/,"");h.tree(d.extend({},l,{toggle:false,parent:k,href:(i!=="#")?i:undefined}))}n=d.Event("nodeselect",{node:d(j).data("tree").node(m)});m.trigger(n)})})}(window.jQuery);