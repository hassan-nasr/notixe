module("rules");test("rules() - internal - input",function(){var b=$("#firstname");var a=$("#testForm1").validate();deepEqual(b.rules(),{required:true,minlength:2})});test("rules(), ignore method:false",function(){var b=$("#firstnamec");var a=$("#testForm1clean").validate({rules:{firstname:{required:false,minlength:2}}});deepEqual(b.rules(),{minlength:2})});test("rules() HTML5 required (no value)",function(){var b=$("#testForm11text1");var a=$("#testForm11").validate();deepEqual(b.rules(),{required:true})});test("rules() - internal - select",function(){var b=$("#meal");var a=$("#testForm3").validate();deepEqual(b.rules(),{required:true})});test("rules() - external",function(){var b=$("#text1");var a=$("#form").validate({rules:{action:{date:true,min:5}}});deepEqual(b.rules(),{date:true,min:5})});test("rules() - external - complete form",function(){expect(1);var b=$.extend({},$.validator.methods);var c=$.extend({},$.validator.messages);$.validator.addMethod("verifyTest",function(){ok(true,"method executed");return true});var a=$("#form").validate({rules:{action:{verifyTest:true}}});a.form();$.validator.methods=b;$.validator.messages=c});test("rules() - internal - input",function(){var b=$("#form8input");var a=$("#testForm8").validate();deepEqual(b.rules(),{required:true,number:true,rangelength:[2,8]})});test("rules(), merge min/max to range, minlength/maxlength to rangelength",function(){jQuery.validator.autoCreateRanges=true;var a=$("#testForm1clean").validate({rules:{firstname:{min:5,max:12},lastname:{minlength:2,maxlength:8}}});deepEqual($("#firstnamec").rules(),{range:[5,12]});deepEqual($("#lastnamec").rules(),{rangelength:[2,8]});jQuery.validator.autoCreateRanges=false});test("rules(), guarantee that required is at front",function(){$("#testForm1").validate();var a=$("#v2").validate();$("#subformRequired").validate();function b(d){var c=[];jQuery.each($(d).rules(),function(e,f){c.push(e)});return c.join(" ")}equal("required minlength",b("#firstname"));equal("required minlength maxlength",b("#v2-i6"));equal("required maxlength",b("#co_name"));QUnit.reset();jQuery.validator.autoCreateRanges=true;a=$("#v2").validate();equal("required rangelength",b("#v2-i6"));$("#subformRequired").validate({rules:{co_name:"required"}});$("#co_name").removeClass();equal("required maxlength",b("#co_name"));jQuery.validator.autoCreateRanges=false});test("rules(), evaluate dynamic parameters",function(){expect(2);var a=$("#testForm1clean").validate({rules:{firstname:{min:function(b){equal($("#firstnamec")[0],b);return 12}}}});deepEqual($("#firstnamec").rules(),{min:12})});test("rules(), class and attribute combinations",function(){$.validator.addMethod("customMethod1",function(){return false},"");$.validator.addMethod("customMethod2",function(){return false},"");var a=$("#v2").validate({rules:{"v2-i7":{required:true,minlength:2,customMethod:true}}});deepEqual($("#v2-i1").rules(),{required:true});deepEqual($("#v2-i2").rules(),{required:true,email:true});deepEqual($("#v2-i3").rules(),{url:true});deepEqual($("#v2-i4").rules(),{required:true,minlength:2});deepEqual($("#v2-i5").rules(),{required:true,minlength:2,maxlength:5,customMethod1:"123"});jQuery.validator.autoCreateRanges=true;deepEqual($("#v2-i5").rules(),{required:true,customMethod1:"123",rangelength:[2,5]});deepEqual($("#v2-i6").rules(),{required:true,customMethod2:true,rangelength:[2,5]});jQuery.validator.autoCreateRanges=false;deepEqual($("#v2-i7").rules(),{required:true,minlength:2,customMethod:true});delete $.validator.methods.customMethod1;delete $.validator.messages.customMethod1;delete $.validator.methods.customMethod2;delete $.validator.messages.customMethod2});test("rules(), dependency checks",function(){var a=$("#testForm1clean").validate({rules:{firstname:{min:{param:5,depends:function(c){return(/^a/).test($(c).val())}}},lastname:{max:{param:12},email:{depends:function(){return true}}}}});var b=$("#firstnamec").rules();equal(0,a.objectLength(b));$("#firstnamec").val("ab");deepEqual($("#firstnamec").rules(),{min:5});deepEqual($("#lastnamec").rules(),{max:12,email:true})});test("rules(), add and remove",function(){$.validator.addMethod("customMethod1",function(){return false},"");$("#v2").validate();var a=$("#v2-i5").removeClass("required").removeAttrs("minlength maxlength");deepEqual($("#v2-i5").rules(),{customMethod1:"123"});$("#v2-i5").addClass("required").attr(a);deepEqual($("#v2-i5").rules(),{required:true,minlength:2,maxlength:5,customMethod1:"123"});$("#v2-i5").addClass("email").attr({min:5});deepEqual($("#v2-i5").rules(),{required:true,email:true,minlength:2,maxlength:5,min:5,customMethod1:"123"});$("#v2-i5").removeClass("required email").removeAttrs("minlength maxlength customMethod1 min");deepEqual($("#v2-i5").rules(),{});delete $.validator.methods.customMethod1;delete $.validator.messages.customMethod1});test("rules(), add and remove static rules",function(){var a=$("#testForm1clean").validate({rules:{firstname:"required date"}});deepEqual($("#firstnamec").rules(),{required:true,date:true});$("#firstnamec").rules("remove","date");deepEqual($("#firstnamec").rules(),{required:true});$("#firstnamec").rules("add","email");deepEqual($("#firstnamec").rules(),{required:true,email:true});$("#firstnamec").rules("remove","required");deepEqual($("#firstnamec").rules(),{email:true});deepEqual($("#firstnamec").rules("remove"),{email:true});deepEqual($("#firstnamec").rules(),{});$("#firstnamec").rules("add","required email");deepEqual($("#firstnamec").rules(),{required:true,email:true});deepEqual($("#lastnamec").rules(),{});$("#lastnamec").rules("add","required");$("#lastnamec").rules("add",{minlength:2});deepEqual($("#lastnamec").rules(),{required:true,minlength:2});var b=$("#lastnamec").rules("remove","required email");deepEqual($("#lastnamec").rules(),{minlength:2});$("#lastnamec").rules("add",b);deepEqual($("#lastnamec").rules(),{required:true,minlength:2})});test("rules(), add messages",function(){$("#firstnamec").attr("title",null);var a=$("#testForm1clean").validate({rules:{firstname:"required"}});$("#testForm1clean").valid();$("#firstnamec").valid();deepEqual(a.settings.messages.firstname,undefined);$("#firstnamec").rules("add",{messages:{required:"required"}});$("#firstnamec").valid();deepEqual(a.errorList[0]&&a.errorList[0].message,"required");$("#firstnamec").val("test");$("#firstnamec").valid();equal(a.errorList.length,0)});